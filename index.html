<!DOCTYPE html>
<html>
	<head>
		<title>Ken Ng's Neighborhood Map Project</title>
		<meta name="viewport" width="device-width, initial-scale=1">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/bootstrap-theme.min.css">
		<style type="text/css">
			html, body { height: 100%; margin: 0; padding: 0; }
			#close-panel-btn {margin: 5px; background-color: white; padding: 2px; border-radius: 15px; border: 2px solid black;}
			#navigation-bar { margin: 0; z-index: 1; }
			#map { height: 100%; margin-left: 20px;}
			#map-container { position:absolute; top: 0; bottom:0; right: 20px; padding: 0; }
			#side-panel { display:none; position:absolute; top: 0; bottom: 0; overflow-y: scroll;}
			#side-panel-open-btn { background:url(img/triangle-left.png) no-repeat center center; background-color: lightgray; position:absolute; top: 0; right: 0; bottom: 0; width: 20px; }
			#main { position: fixed; top: 55px; bottom: 0px; width: 100%; }
			#id { margin: 5px; background-color: white; padding: 2px; border-radius: 15px; border: 2px solid black; }
			.inline { display: inline; }
			.no-margin { margin: 0;}
			#side-panel-header { text-align: center; background-color: white; padding: 10px; border-radius: 10px; border: 2px solid lightblue; }
		</style>

	</head>
	<body>
		<nav id="navigation-bar" class="navbar navbar-default">
			<div class="container-fluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#">Ken's Map</a>
				</div>
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="nav navbar-nav">
						<li><a data-target="#optionsModal" data-toggle="modal" href="#">Options</a></li>
					</ul>
					<form class="navbar-form navbar-left" role="search">
						<div class="form-group">
							<input data-bind="textInput: newAddress" type="text" class="form-control" placeholder="Search">
						</div>
						<button class="btn btn-default" data-bind="click: updateAddress">Submit</button>
					</form>
				</div>
			</div>
		</nav>


		<div id="main" class="container-fluid">
			<div class="row">
				<div id="map-container" class="col-md-12 col-sm-12 col-xs-12">
					<div id="map"></div>
				</div>
				<div id="side-panel-open-btn"></div>
				<div id="side-panel" class="col-md-offset-9 col-sm-offset-6 col-md-3 col-sm-6">
					<input id="close-panel-btn" type="image" src="img/close.png">
					<h3 id="side-panel-header">Nearby Places</h3>
					<div class="input-group">
						<span class="input-group-btn" class="img-responsive">
							<button class="btn btn-default" type="button" data-bind="click: filterPlaces">Go!</button>
						</span>
						<input type="text" class="form-control" placeholder="Search for..." data-bind="textInput: searchTerm">
					</div>
					<br>
					<div data-bind="visible: isLoading()">
						<img src="img/ajax-loader.gif">
					</div>
					<ul data-bind="visible: !isLoading(),foreach: placesFilteredArray()" class="list-unstyled">
						<li data-toggle="modal" data-target="#myModal" data-bind="click: $root.selectPlace">
							<div class="panel panel-default">
								<div class="panel-heading" >
									<b><span data-bind="text: labelIcon"></span></b>
									<span data-bind="text: placeResult.name"></span>
								</div>
								<div class="panel-body" data-bind="text: placeResult.vicinity">

								</div>
							</div>
						</li>
					</ul>
				</div>
			</div>

		</div>


		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document" data-bind="visible: currentPlace(), with: currentPlace()">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<img height="20px" width="20px" data-bind="attr: {src: placeResult.icon}">
						<h4 class="modal-title inline" id="myModalLabel" data-bind="text: placeResult.name" >Modal title</h4>
					</div>
					<div class="modal-body">
						<img data-bind="attr: {src: imageUrl}">
						<h4>Information</h4>
						<p data-bind="text: placeResult.vicinity"></p>
						<p data-bind="visible: placeResult.opening_hours && placeResult.opening_hours.open_now">Open Now!</p>
						<br>
						<div data-bind="visible: !isWikiFailed()">
							<h4>Wikipedia Information</h4>
							<div data-bind="visible: !isWikiLoaded()">
	  							<img src="img/ajax-loader.gif">
							</div>
							<ul class="list-unstyled" data-bind="visible: isWikiLoaded() && !isWikiFailed(), foreach: wikiInformation">
								<li>
									<a target="_blank" data-bind="text: name, attr: {href: link}"></a>, <span data-bind="text: desc"></span>
								</li>
							</ul>
						</div>
						<div data-bind="visible: !isNYTimesFailed()">
							<h4>New York Times Articles</h4>
							<div data-bind="visible: !isNYTimesLoaded()">
	  							<img src="img/ajax-loader.gif">
							</div>
							<ul class="list-unstyled" data-bind="visible: isNYTimesLoaded() && !isNYTimesFailed(), foreach: nytInformation">
								<li>
									<a target="_blank" data-bind="text: name, attr: {href: link}"></a>, <span data-bind="text: desc"></span>
								</li>
							</ul>
						</div>
						<div data-bind="with: userData">
							<h4>User Comments</h4>
							<p data-bind="visible: commentArray().length == 0">
								No user comments
							</p>
							<ul class="list-unstyled" data-bind="visible: commentArray().length > 0, foreach: commentArray">
								<li>
									<p data-bind="text: date"></p>
									<p data-bind="text: comment"></p>
								</li>
							</ul>
							<textarea data-bind="textInput: newComment"></textarea>
							<button data-bind="click: addComment">Add New Note</button>
						</div>

					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>


		<div class="modal fade" id="optionsModal" tabindex="-1" role="dialog" aria-labelledby="optionsLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title inline" id="optionsLabel">Ken's Map Options</h4>
					</div>
					<div class="modal-body" data-bind="with: mapOptions">
						<div>
							<label for="input-map-range">Range</label> <input id="input-map-range" type="number" data-bind="value: range">
						</div>
						<h4>Place Type Filters:</h4>
						<ul class="list-unstyled" data-bind="foreach: placeTypePrefs">
							<div style="display:inline-block; width: 30%">
								<input type="checkbox" data-bind="checked: isSelected, attr: {'id': placeTypeId}"> <label data-bind="text: name, attr: {'for': placeTypeId}"></label>
							</div>
						</ul>

					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal" data-bind="click: $root.updatePlaces()">Update</button>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="locationsPickerModal" tabindex="-1" role="dialog" aria-labelledby="locationsLabel">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="locationsLabel">Please pick one</h4>
					</div>
				<div class="modal-body">
					<ul class="list-unstyled" data-bind="foreach: partialAddressList">
						<li>
							<h4 data-bind="text: formatted_address, click: $root.selectNewAddress"></h4>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</div>


		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script type="text/javascript" src="js/bootstrap.min.js"></script>
		<script type="text/javascript" src="js/knockout-3.3.0.js"></script>
		<script type="text/javascript" src="js/json2.js"></script>
		<script type="text/javascript" src="js/app.js"></script>

		<script async defer
			src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBPQb5Rww_wcIz5VbhbpX55AARXlc_E7dU&callback=initialize&libraries=places">
		</script>
	</body>
</html>